app-id: org.qtedit4.qtedit4
runtime: org.kde.Platform
runtime-version: '6.8'
sdk: org.kde.Sdk
command: qtedit4

finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --device=dri
  - --filesystem=host

modules:
  - name: qtedit4
    buildsystem: simple

    build-commands:
      - cmake -S . -B build
          -G Ninja
          -DCMAKE_INSTALL_PREFIX=/app
          -DCMAKE_BUILD_TYPE=Release
          -DQTEDIT4_WORK_OFFLINE=ON
          -DBUILD_VERSION=CE
      - ninja -C build
      - ninja -C build install

    sources:
      # Main application
      - type: git
        url: https://github.com/diegoiast/qtedit4.git
        commit: d09365bc68ebc1b9b543f84b9b21c71c889f1353

      # Vendored dependencies (offline mode)
      - type: git
        url: https://github.com/diegoiast/qmdilib.git
        commit: b687217f325500d44f868b894ee1eab72d692708
        dest: lib/qmdilib

      - type: git
        url: https://github.com/diegoiast/qutepart-cpp.git
        commit: 9b419096b31d637e33805f8e3e1d1a1b8f27869a
        dest: lib/qutepart-cpp

      - type: git
        url: https://github.com/diegoiast/command-palette-widget.git
        commit: 3c4e338216936097e89e8a19e1c325018d7e750c
        dest: lib/command-palette-widget

      - type: git
        url: https://github.com/palacaze/image-viewer.git
        commit: 125ea784f93327b471cd9b6b156285e40e70280a
        dest: lib/image-viewer

      - type: git
        url: https://github.com/dridk/QJsonModel.git
        commit: f5fa5988c0ee52fff39a42973c964d5480951f86
        dest: lib/QJsonModel

      - type: git
        url: https://github.com/alex-spataru/QSimpleUpdater.git
        commit: 8e7017f7fbdc2b4b1a26ed1eef9ebcba6a50639c
        dest: lib/QSimpleUpdater

      - type: git
        url: https://github.com/Dax89/QHexView.git
        commit: 5fe6d9851ecfae0acf26d1659ee3cb579d03202f
        dest: lib/QHexView
